#!/usr/bin/env python
#-*- coding: UTF-8 -*-

import sys
import os
import six
import re
syntax = '''
---------------------------------------------------------------------------------------------------------------------

Syntax: python makeDegenerateMotif.py

---------------------------------------------------------------------------------------------------------------------
'''

def make_degenerate_motif(motif_seq):

	""" Degenerate sequence using regular expresions -> re.compile()
	Example: GTWBNNH -> GT[AT][TCG][GATC]{2}[ATC]
	"""

	if not isinstance( motif_seq, six.string_types ):
		raise TypeError( "motif_seq must be a string!" )
	degenerate_code = { "A":"A", "B":"[CGT]", "C":"C", "D":"[AGT]", "G":"G", "H":"[ACT]", "K":"[GT]", "M":"[AC]", "N":"[ACGT]", "R":"[AG]", "S":"[GC]", "T":"T", "V":"[ACG]", "W":"[AT]", "Y":"[CT]" }
	regex_string = ''
	idx = 0
	while idx < len( motif_seq ):
		curr = motif_seq[idx]
		count = 1
		for next_idx in range( idx+1, len( motif_seq ) ):
			next = motif_seq[next_idx]
			if next == curr:
				count += 1
			else:
				break
		regex_string += degenerate_code[curr]
		if count > 1:
			idx = idx + count - 1
			regex_string += "{%s}" % ( count )
		idx += 1
	return regex_string

print('\n\n\tGTWBNNH:')
print('\tExpected: GT[AT][TCG][GATC][TAGC][ATC]')
print('\t\t  ' + make_degenerate_motif('GTWBNNH'))
print('\n\tDBYHWNMHDYAG:')
print('\tExpected: [ATG][CTG][CT][ATC][AT][ATGC][AC][CAT][ATG][CT]AG')
print('\t\t  ' + make_degenerate_motif('DBYHWNMHDYAG'))

#########################################################################
#

test_list = ['GAAAAATGCTTGAAGATCGTAAACAAGAAGTTGGAGACTATACTCTTGGACGTACATTAGGTAAAGGAACAACAGGAAAAGTAAGGATTGCAACAAAGCAAGGATCAGGACAACAATATGCCATTAAAATCGTAAAAAAATCATTATTCGAAGCAAAGCCCCAATTAGAAACAAAAATTAGAAGGGAAGTCGGTTTGATGAGACTTTTAAATCATCCTCATCTTCTTAAGTTTGAGGAATGCTTTGAATCTCATCGTCATTTTTATATTGTACTTGAGTATGCCGAAAATGGCGAACTCTTCGACTTCTTAATTAAACGAAAATCGCTTACACTGGAATGTGGAATGCATTTCTTCCACGAATTGCTTTATGGCTTAGAATATTTACATGAACACGCTATTTGCCATAGAGATCTTAAACCCGAAAATATCCTCTTGGATCAGTTCAACCACATCAAGATTGCAGACTTTGGATTTGCACGCTGGATGCGTTCAAATATTGCAGAAACATCTTGCGGTTCTCCACATTATGCAGCTCCCGAAGTTATAAAGGGAAGCACATATGATGGAAGAGCTGCAGATATTTGGTCTCTTGGCGTCATTTTATTCGCTTTACTTGCAGTATGTATTATTTTTTTTAATACATCACGCAAATCAAACATAGCTACCGTAACTTAATTTACTTAAGGAAAATTAATTGTAATTTGTTTTATCTTAGAACAAATATAATTTTTTTGTACTATTAGTTTTAGTTACGCTAAGCTTAAATGATTTGCAGATGTATGTTTTAACGAATTTACTAACACGCAGGGTAGACTTCCATTTGATGATCCATCAATTCGCAATTTATTGGCCAAAGTTAAATCAGGAAGGTATAGAATGCCAGATTTTCCACCTCCAATTCAAGATCTCATCTCGAAAATGCTTACAGTTGATCCAAACCTCAGAATTACAATCGATCAAATTAAAGTTCACCCATCATTCAGGATGTTTTGCCTAGAAAAATACGTATTTCCAACACCTCTTCGTCTTCCATTTATTACGAGCCCGGTTGATCCAAAAGACGTTCCATGGGCAACATATACTGTCCTGAAGTCAATTGGATACCAATCTGATGAGGAGATCAACGAAGAACTTCGTGCAGAGACCCACACTATGGCCAAGGTTTTCGCTCATATGCTTACAAGAAATATCTCAATTGATACTCTCAAATGGCCCACTGATTCTTCTGCTGATGATGCAATTCCTAACGATGCATTCATCATCTCACCAAATGTTCTCCCAATGGGCTCTGCAAATTCAGCAGATTCATTCGGACGTCGCAGAGCGATTCCTGACGTTTCTTCTCCGGAAACATTCTCACTTGTTGAGAGAAGATACACTGCTGAATTTAATGACACTCCAGAACTCGAAATGGAACCTCAATCATTTGAAAAAATCCCAATTCCTATCGAAGAACTTATGCTTACACTCCAAACATGTCTTTCAAACGCTCAATATGAATGGCTTCACCCAGATGATATGCATATCTACGCTAGAAACACCGTTGACAATTCTTACGTTGTCTTCACAGCGATTTTCATTGATGAGGATATGCTGAGACTCACAATGCTTCCTGTAAGAATTGAATCCGACCAGTTTAACGCTCTTATTGAAACTGTTTCGATTTCAATTCAAGAAGCGATTGATAATTATTCAACAAATGATGCACTTAATGAAG',
'GATCTCGCGAAAAATCTATCTGAAGGATGTTCTGCTGCAGTAATTTTCATGACACTGCTGCGATGGATTTCCATAATTTATTAGTCGGAGTACGTAGTGGAGACGTGACCTTTCGTTTTCTTCTTGAAAACCCCACAACCCTTACAATGCTCCAACGTAATGTCGCCGAGTTGAATGATTTGTATGATTTTATTTCTAACAAACAGCTTTAAAGAGTACAAAGACAAATTTATTAACACGTTGTTGTATTCTGAAGATTTCAGAGTACAGAAGGCGGCCATGAGATTGTTTATGCTTGGCAACAAGCATGTATCTGTACTAGTTTCTGAGGCTGAGGAACTCAAAAACTACGCAAATAATCTGAATGAACAATCCAACTTTTACATAATATGTAACATTATTCAGACCTGCGTAAACAACTTTCCATCCTGCATCTCGGATGCCCTCTCCTTTGTTCCCTCATTGATAAAATTTGCCTTTTCTTATCAAATTGTATCAATGTTCGAAGACTTGCTAGACCCTATCAATGACCTCACCTTCGTCTACAACTTCTTTAACGAGGCCAACTTGTTTGATTCTATTGTTAATTTGTATAATAAGTCGGATCTAGATTGCAAACAAGGCCTCCTTAGAATTATTAAGTGCATGCTCATCAACCAGATTACGAACCAAAAGATCAGCCAACTTCAATTACACGAAATAATTGAAGATGCGATTAACTCGGAATCAACAACAAACAAAAATCTTGGCTGGTCGATTGCATTTATTGATATCAGGTACTTTGGGTCTAGTGTCATTGACCAAGCGAAACTTTTTGAAGATTCCGCTTCAGCAATTTGCCAAAACGAAACGACTGGCTTCCTTGAATACCAAGTCAATGCATTGCAATGCATGAATACAATCATGGTTTCGGTCCTTGACTCAATCGCTGACTTCGATTTCAAAAATGTTATCAGGAAACTTTTGGATGTATATATGAAGTGTCCGGGCCATTCGATTGCATACCAAGCTATATTTGATTTCGTCATTAACTTATCCAATAATTCTAAGTACCGTAGTCTTATTTTTAATTCTTTTGTTCCTGATGTCATGGAGACAGCCAAAACGTCGAAGAATACTACCCAAATATCGTTTGCAAATGATTTCTTTATGAAACTCAGCTTGCAAGTCTTTAATGATGAAACTTATCGAAATGACATACCTTCGGACATTTACCAATACCTTTCAAGCTTCAAAGTTGATACAAATTCCTTCTCTGCTTTCTTTCATCCGTCAATTGCAGATTTTCCTGATGATATCATGGAAGAAGTTCTGTTTGCAGGCCTATAATTACGTGTTTGTTATTTCTCATGAATAAAGTTTAAATACAGCTTTTTTCTCGTTCGCAA',
'ATGAGTAATGGAAATCTAACAGACGACGAAATAGATTCCAGCTCATCTAGCAGTGATGCTACAGAGAACTTGTGCTTGTCATTAAATAAAGTTCGTGACATCGAAATTGATCTTGTAAAAGTCCTTTTCGGCCGTGATAGGGCTGCAACGTATATCAAGATAACTAATGGCATTAGAGGTATTGATCCAGTCGATCCATACTATCAAGATTCAATAACTGGTAAAGTCACAGAAACTTTAACAGAATCAATCGAAACCTTGACATTTACTGGTCAGGATATTGATAATATTCCTCTTACTGTTGTTAGTATTGCTAACAGTGCTCCACCACAACCTACTTCTTGCTGCGATTTTTGTTGTGCAAAACAAAAAGTTTATCCAACGAGAAGTACCCCATATTCTAAGTACTCAGTATGTATATTTTTGTTTCATATTTCCTATTTGGAAATTTGAAAACATTTTTTGGAAAAAATTTACTAACACACAGATTGCTAATAAATCTATGGATTTACTACCACCGAAAGATCCAAAAGATCATAAAAAGATTACCCTTGTGCTCGATGTAGATGAAACCCTTATTCACAGCACTTTTGAGAACGATCCTCATCATGATTTTCATTTTTCAATGACAAACGATGACATCACATATGATATTTATGTTTCTGTCCGTCCTGGATTAAAGAAATTCTTGAAAACCCTGTCAAAACACTTCGAATTAGTTGCTTTTACAACAGCAAGGCAAAACTACTGCGATTACATACTTGACAGAATAGACCCTGATCATTTGATTAAATACAGGCTATATAGAGAATCATGCATCATATATAATGGCACATTTGTGAAAGATCTCTCATTATTAGGTCGAGACTTGAGAAAGGTCATTATTGTTGACAATTCACCATCTTGCTATATGCTCCAGCCTTATAATGGCCTCGCTATTCAAGATTTTAATGGAAATCCAGAAGATAACGAACTTCAGCATATAACAGACTTCCTTATAAAGAATGCTAAATGTGAAAATGTTTTAGAACTTTTCGCAGCATAG',
'ATGAATTCTGTCAGCACTGAATACTTTGTTGATCCTTGTGATGGAGTCGCAAATGACGGCTACGATAATAAAGATGGAGTTCTGATTGTTTCGAAAGACCAAACTATTAAAGGACCAAATGAAACGTATTTCACAATTTTGAGCCCTCTTGGCAATGGGCAGTTTGGAAACGTTTTTCAGGTTTTATGCATGTCGGCTGATATGGAAGCCCCAGTAGTCTATGCGATGAAAATTACAAAATCACAGCAGCATTATCAAGATCAAGCAAACCATGAAATAGAAATTCATCGTAGAGTACGTATTTCATCTATGCATAATTTATGCATAGATATTTTTTCAAAACTAACACACAGATTCAAGAAAAAATAGCTGCTGAAGATAGAAAATACATAATCACAATGATTATGGCATTTGAATATCACAATCATGTATGTATTGTCAGCGAATTATTATCAGTTGACTTATATCAAGTGTTAAAATATCGAAATTTCAAAGGTCTTTCAATAAGTCTTGTCAGGAATTTGTTAAAGCAACTTCTACAGGATTTAGTTGTTTTAAAAAAGATCGGAATTATACATGGCGATATAAAACCAGAAAACATCATGAGCGTAAACGGAAATAATGCAATTAAACTTATCGATTTTGGTTCTGCCAAAACAGAAGGTAATTTTTCAGATTTTTACTTTCAATCGAGATACTACAGGGCTCCAGAAGTCGTATTGAATCTACCGTATGATTATAAAGTTGATGTTTGGAGTGTTGCCTGCGTTGCTATTGAGATGTTTATTGCAAATCCGATATTTGCTGGACAGAACGAGCTATATTTATTACAGCTTATTTCTCAATACGTTTCACAAATTCCGATATCAATGATACGTAGCTCCCCAAGAAGGAAAGACTTTTTTAACCACGATAACACACTGAAGACATTAAATCAATATTGCTACGAAAATGGAATCCAAGTTCCTCAATTTCAGCCATATTTAATTTATAATACAATTTCAGAATTGATTATGAAATACCCCATTGCTCGTGCCAATAAACAAGGGGATTTTCTTCAAAAGGAGATGACTAGAAGAGAACATTTCTTGAAATTAATTCAAAAGATGCTAATTATAGATCCAAAACTAAGACCAACACCAGAAAAATGCTTAGAAGACCCATTCTTTACAATTCCTTAA',
'ATGGATACGTCGACTAGTCCTCAGCGAACTGGAACCACGGCTGCTCCATTTCAGAACTCACTGGCTGCGAGGCTTGAGCGTGGGGAGCTGAATTTGGACTCGATCCTTCTGGATCGATTCGCAATCAACTCATTAAAAAGGAACAATAAAGTTCTTACAGAATAGTTCATTTTATTTTCTAACAAACAGTATTTTACATAATATCAATCAGTTCATTGACATTCTATTGAATAGCAGCGACAAAAATCTTCGAAATGGAGCCTTTAAAGCACTTCAATACGGAAATAAATCAATTCTTAGAACAGTAGCAGATTCTCCAATAGTCCAAAATTCTGGAAAAGGCAATGTTACCGAAGAAAATGTTGATAATCTAGCGATTATTATTGAAACAGCTTTATCTACATTTCCAGAGTTAATAAGAACTCAATTCAAATTCATACCAAGCTTGATAAAGTACATAAATCATTCATCAATCGAATACATGTTTCAAAGCCTTCTTTCTTCAGAAGAACGTTTACTACCGATTCACAACTTCCTCAAATTTATTGAATTTCCAAAATACGTAGCATTTACAGCAATGAAAGCAGAAGGAGAAGAAAAATTATTATTAATGAAGTTACTGCAAAACTGTATAGAAAACAGAGTGTTAATGTCATCATCTGTTGGAAGTGATGCTATCAGTCTTATTAAATCTTGCATCAGTAGTGATAACAACGAATATCGCAAATTTTCATTTAAATTCTTATATCAAGCCGTAATAATTGATGATTATGATGAGGAAATTGCTCGATTATTCATTCCTGATGCAATAGATGCATTTAGCTGCACTTTAGGTGATTATTACTATGAATACCAAGTCATGGCAATTAAATTCCTTTCAAGACTGATCGAGCTTAGACCAGTGACAACTATATCACTTGAAAGTGATAATGTTGTCCAAAGCCTTTCCGAAATTTTTGTGAAATTTAATTCGCATTCTTTTGCACTTTCAGCCGTATTCGAAATGATTTACAAGACAATTGACGATGCTTTGTTTAGACAGTCAATCTTTAATATTTTCCTCCCGTTAGTATTAAATGCAATTAAAGAGCCTGCATCTTCCACACAGCATTCCTTTGCACTTAGATTCCTTCATGATTTAGAAGTGATTGCAAGGAGGGACATTTTGATGCAAGAAGAATTAACTCAAGATATAAAATCAGCTTTTGCCACTTACTGTCAGCCATTTGATGACATGATTCGTTCTGATTCTCCAGTAAGGAGTGGGGAACTATACGACGATATTATGGATGTTGTTGAAATTCCATTTGTTCAGTCAAGACAACTATATGACTCTCAAGGGTTTTAA',
'ATGACAGAAAATATTTCTATCATGAGTATAATGAACCCTCCTAATGGATACGTTTTTGATGAAGTTATCGGAAGTGGTAGCTTTTCAACTGTTTACAAAGGGCATCAACTCCAAACAAACAAAACTGTTGCAATTAAAGTAGTTAAGCGTAATCGATTAGATGCTGAGTCTTCTCGTAAATTTTATTCAGAAGCAAGGATTTTATCCAATCTAGTTCATCCCCATATAGTTAGATTCATTGCTTTAATGCAAGATGATGACTGCGAATTTTTAATAATGGAATACGTATCTGGTGAATCCCTGAGAGATTTGCTCGAACGTAAGACCCATTTGTCAGAAAATCAATCGCGTCGTTATTTCATTCAAATTCTCTCTGCTCTCGAGTATTTTCACAATACAACTCAATTACTTCATCGCGATCTCAAAGTAGACAATATTATGATCGATCATAGTGACAACATTAGGATCATTGACTTCGGTTTGGCAGGAAAATACGATGAAAACGATCCAAACAGATTTTGTGGATCACCAAGTATGTATTTTTAATTTTTGGAGTGTTATATTGATCATTCCAATGTTTATCATATAACTAACACACAGAATACGTTTCTCCAGAGATATATAAAAGAGTTCCTTATACCGAAAAAGCTGACATATGGAGCTTAGGAGTTATTCTTTATTTGATGACTGTAGGATCATTACCATTCATTGCAGATACTCTTCCAATGCTTTCTTTCGCTGTCAGAGTTTCTGAACCAACATTTCCGCCAACAATGACTCCATCTTTACGACAACTCTTAATTTCAATGCTTGAAAAGGATCCAGAAAACAGGCCAACCATTGAGAAGATAAGAATGTCAAGATGGCTCATGGAAAGACCAAGATTACAATCTCTTATCTCCAACAAACCAAATTCAGCAAAGACTTCTCCACATGATTCACCAAGAAACTCTGTTGACCCTGTTGACGCAAACAGTATCGTTGATAGACTGATAAAAACAGGAAGATTCAAAAGAGCCAATAAAATGCCAGTCTCAAGAAGCTCAAACGTTCAACTCCCTGATTCATACAGCGAAGAAAAAAACGAAACAATATCATCTCGTCTTAGAGAAATTGCAAAATGCGATGTCGCGAGGCATAACAGCATTCCTATTGGTTCTCCTAAGCCAATTATGAATACAAATGAGTAG',
'GTTCCGTTGAACCTGCAAAGGATCCTATAGATGAATTCGATCAATTCTTTAAGGATTTGCAAGTCAGTAAAGCAGTGAAGTCTTATTCTGATAAAAAAGCAACTTTGTTCTATTTATTTTCTAACAAACAGCTTGGCCACTCATATTGAACAGATTTTAAATCTCATTTTAGCACCAGAGCTAACAGAACAAGGACATAAAGCATTTTTATTATTTACAAAACCAAATCCGCTACTCATATCAGCATTAACAGAAAACGACATTTTATTTTGCCTCGGAACTCAAGCAATCATGAACGACAAGGATAAACCAGCAGTTATAAGTCGGCTTTCTACAATTTTTCTTTGTTTATTAACAGAATGTCCATCCGCCTGCCACGAATCAACAGGATTTCTATATAATTTGCTTGAATTCGTAGATAATACCGGCGTGTACGATCTTTTCAAAGAAATTTTCAAAAAAGACTCTGAATTAAGAGTAATTCAAGAGTTCTTAGTCGAAACTAAACTTACAACTTATATCGTTCGCATACTTCGAGAACATGAGAATCTTGAAACTATAAAATGCATGCTACGTCTAATTTCTCATGGAGCAAATAATAAAATTATGTGGCCATCTTTTTGCTCTGATGAAGTATGTGAAGCGCTTATATTTAGATCAGGAATCGAAGAAATCAAAAATGAGTTATGGGAAGCAGTAAATGCAGTAGTTTGTACAAAAAATGTCCAAACAATGAAAAATATCATACCGCAAGCTATAAATCTAATAACAACTACATACATGAAACCTACAGCTGCTTTAGCCTATTCTTTCGACTTTCTTTCAAAAATAATTCGACGAAGTGTTGAAAGTTTTACAGTTGAATCAGTCAACCAATTATTATCATCAATAATTAGTTTACTTGCGATCGTTCCTGATTCTTCTAATTTACTTGGAGCTGCATTTCGTTTAATTACATCTTGTGTTAAAATTAAGAATTTTACTCAACCAACATTGGACATGGTCTTACCAGTTCTTGCCGCAGAAGCACCTTCTAGGGTTAGATGCGCAGCTACAGCAAATTGTGCAAATTTTATATTGAATTTACAAGATATGGCTTCAAAAGATGCTGAGCTCTTCAAATTACTTACGAAATACGAAGATTACCAAGAAATTTGTTCAAGATTTTTGCCTTGGTACTCTAATGTTATCAGTTCGAACTACAGAGGTGTTATTTCAATA']

regex_1 = re.compile(make_degenerate_motif('GTWBNNH'))
regex_2 = re.compile(make_degenerate_motif('DBYHWNMHDYAG'))

for val in test_list:
	match_res1 = regex_1.search(val)
	match_res2 = regex_2.search(val)
	if match_res1 and match_res2:
		print('Match patterns: ' + str(match_res1) + ' ' + str(match_res2))
	else:
		print('Not found')
